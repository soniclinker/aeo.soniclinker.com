(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8297],{6246:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});let s=(0,l(95551).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},28067:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});let s=(0,l(95551).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},48963:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});let s=(0,l(95551).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},49279:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>m});var s=l(37876),n=l(14232),a=l(9614),r=l(89099),i=l(65259),o=l(43598),u=l(42059),d=l(74562),c=l(6630),v=l(98188),h=l(14084),f=l(21358);let m=()=>{var e,t,l,a,m,x,k,y,g,w,p,j;let A=(0,r.useRouter)().query.runId,[_,N]=(0,n.useState)([]),[S,P]=(0,n.useState)(null),[q,E]=(0,n.useState)(null),[C,F]=(0,n.useState)(!1),[D,I]=(0,n.useState)(!1),[R,z]=(0,n.useState)(null),[G,L]=(0,n.useState)(1),[M,B]=(0,n.useState)(10),O="My Brand";if(null==q?void 0:null===(t=q.result)||void 0===t?void 0:null===(e=t.info)||void 0===e?void 0:e.args){for(let e of q.result.info.args)if("brand"===e.id){O=(e.value||"").trim().split(",")[0].trim();break}}let T=[{name:O,sov:(null==q?void 0:null===(a=q.result)||void 0===a?void 0:null===(l=a.own)||void 0===l?void 0:l.sov)||0,queries:(null==q?void 0:null===(x=q.result)||void 0===x?void 0:null===(m=x.own)||void 0===m?void 0:m.queries)||[]},...(null==q?void 0:null===(k=q.result)||void 0===k?void 0:k.others)||[]];T.sort((e,t)=>t.sov-e.sov);let X=Math.ceil(T.length/M),H=T.slice((G-1)*M,G*M);(0,n.useEffect)(()=>{G>X&&X>0?L(X):0===X&&1!==G&&L(1)},[T.length,X,G]),(0,n.useEffect)(()=>{(async()=>{F(!0),z(null);let e=await o.A.checkAndGetAeoProject();if(!e)return z("Project not found"),F(!1),d.A.show("Create new project",(0,s.jsx)(c.default,{}),!1,"90%");let{data:t,error:l}=await i.A.doGet({path:"/orgs/".concat(o.A.current().id,"/aeoanalysis/tasks?queryset_id=").concat(e.id)});if(l){z("Failed to fetch runs"),F(!1);return}if(N(t.tasks||[]),A&&t.tasks){let e=t.tasks.find(e=>e.id===A);e?P(e):t.tasks.length>0&&P(t.tasks[0])}else t.tasks&&t.tasks.length>0&&P(t.tasks[0]);F(!1)})()},[A]),(0,n.useEffect)(()=>{let e=async()=>{if(!S)return;I(!0),z(null);let{data:e,error:t}=await i.A.doGet({path:"/orgs/".concat(o.A.current().id,"/aeoanalysis/tasks/").concat(S.id,"?fetch_result=true")});if(t){z("Failed to fetch analysis data"),F(!1);return}E(e.task),I(!1)};S&&e()},[S]),(null==S?void 0:S.name)||(null==S?void 0:null===(y=S.data)||void 0===y?void 0:y.queryset_name)||null==S||S.id;let K=S?new Date(Number(S.created_at)).toLocaleString():"-",Q=null!==(j=null==q?void 0:null===(p=q.result)||void 0===p?void 0:null===(w=p.all)||void 0===w?void 0:null===(g=w.queries)||void 0===g?void 0:g.length)&&void 0!==j?j:"-";return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-col bg-white",children:[(0,s.jsx)("div",{className:"sticky top-0 z-30 bg-white",children:(0,s.jsx)(u.A,{})}),(0,s.jsx)("div",{className:"sticky top-[57px] z-20 bg-violet-50 flex flex-col md:flex-row md:items-center md:justify-between mb-2 md:mb-0 px-6 py-4",children:(0,s.jsx)(f.A,{runs:_,selectedRun:S,onSelectRun:e=>{P(e)},runDate:K,numQuestions:Q})}),(0,s.jsx)(h.A,{headers:[{label:(0,s.jsx)(b,{label:"Brand"}),key:"brand"},{label:(0,s.jsx)(b,{label:"Mentions"}),key:"mentions"},{label:(0,s.jsx)(b,{label:"Share of Voice"}),key:"sov"}],data:H,isLoading:C||D,rowKey:e=>e.name,renderCell:(e,t)=>{if("brand"===t.key)return e.name===O?(0,s.jsx)("span",{className:"text-[#4F46E5] font-bold",children:e.name}):e.name;if("mentions"===t.key)return e.queries.length;if("sov"===t.key){let t=e.sov;return"number"==typeof t?Number.isInteger(t)?"".concat(t," %"):"".concat(t.toFixed(2)," %"):"--"}return t.key in e?e[t.key]:void 0},className:{table:"h-[calc(100vh-12.1875rem)]",header:"border-b border-neutral-200 text-neutral-500 text-xs font-medium bg-neutral-100!",body:"border-b border-neutral-200",bodyData:"text-sm"},children:(0,s.jsx)(v.A,{currentPage:G,setCurrentPage:L,totalItems:T.length,itemsPerPage:M,setItemsPerPage:B})})]})})},b=e=>{let{label:t}=e;return(0,s.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)(a.H2l,{size:16,className:"text-neutral-500"})]})}},75889:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/aeo/competitive-insights",function(){return l(49279)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[7141,9034,4249,9946,636,6593,8792],()=>t(75889)),_N_E=e.O()}]);